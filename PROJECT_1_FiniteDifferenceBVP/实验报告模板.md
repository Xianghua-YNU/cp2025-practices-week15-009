# 项目：二阶常微分方程边值问题求解 - 实验报告

**学生姓名：** [肖婷丹]
**学号：** [20231050134]
**完成日期：** [2025.6.4]

## 1. 实验目的

本次实验旨在通过求解一个具体的二阶线性常微分方程边值问题 $y''(x) + \sin(x) y'(x) + e^x y(x) = x^2$ (边界条件 $y(0)=0, y(5)=3$)，掌握并比较有限差分法以及 `scipy.integrate.solve_bvp` 函数这两种数值解法。理解它们的基本原理、实现过程和适用场景。

## 2. 核心算法与实现

简要描述你对每种核心方法的理解和实现思路。

### 2.1 有限差分法 (Finite Difference Method)

**算法思路：**
[将区间（0,5）离散化为n+2个网格点，使用中心差分近似导数：二阶导数：$y''(x_i) ≈ (y_{i-1}-2y_i+y_{i+1})/h^2$，一阶导数：$y'(x_i) ≈ (y_{i+1}-y_{i-1})/(2h)$，在每个内部点建立方程，构建三对角线性系统，处理边界条件，求解线性系统]

**关键代码片段 (可选)：**
```python
# 构建系数矩阵
for i in range(n):
    x = x_grid[i+1]
    a_im1 = 1/h**2 - np.sin(x)/(2*h)  # y_{i-1}系数
    a_i = -2/h**2 + np.exp(x)         # y_i系数
    a_ip1 = 1/h**2 + np.sin(x)/(2*h)  # y_{i+1}系数
    
    if i > 0:
        A[i, i-1] = a_im1
    A[i, i] = a_i
    if i < n-1:
        A[i, i+1] = a_ip1
    
    b[i] = x**2  # 右端项
```

### 2.2 `scipy.integrate.solve_bvp`

**使用方法：**
[将二阶ODE转换为一阶系统：设y0 = y, y1 = y'，dy0/dx = y1，dy1/dx = -sin(x)*y1 - exp(x)*y0 + x^2，定义边界条件：y0(0)=0, y0(5)=3，提供合理的初始猜测]

**关键代码片段 (可选)：**
```python
def ode_system_for_solve_bvp(x, y):
    dydx = np.zeros_like(y)
    dydx[0] = y[1]  # dy/dx = y'
    dydx[1] = -np.sin(x)*y[1] - np.exp(x)*y[0] + x**2
    return dydx

def boundary_conditions_for_solve_bvp(ya, yb):
    return np.array([ya[0], yb[0]-3])
```

## 3. 实验结果与分析

### 3.1 数值解的可视化

[![1](https://github.com/user-attachments/assets/9917e502-12ae-4d4f-a451-02978d33496a)
]

### 3.2 结果比较与讨论

[针对你得到的数值解进行比较和讨论。例如：
- 两种方法得到的结果是否一致？如果存在差异，可能的原因是什么？  两种方法在整体趋势和数值大小上表现高度一致；差异原因：离散误差：有限差分法的固定网格与solve_bvp的自适应网格不同；截断误差：有限差分法的二阶中心差分近似引入截断误差；算法差异：solve_bvp使用搭配法，全局误差分布更均匀；边界处理：有限差分法显式处理边界，solve_bvp隐式处理
- 你是如何选择离散点数 `n_points` 的？它对解的精度和计算时间有何影响（如果进行了探究）？  有限差分法通过收敛性测试确定，solve_bvp选择依据：保证初始分辨率
- 对于有限差分法，网格点数对解的精度有何影响？边界条件是如何处理的？  n<30时误差显著，n>50改善有限，边界条件通过修改矩阵首末行严格保证
- 对于 `solve_bvp`，初始猜测对结果的影响如何？收敛性如何？  初始猜测质量决定收敛性
- 哪种方法你认为最容易实现？哪种方法最鲁棒或最高效？  有限差分法需确保边界条件正确实现，solve_bvp必须提供合理初始猜测，对于非线性问题，solve_bvp可能更可靠]

### 3.3 (可选) 精度分析

[数值比较：
   最大绝对误差：2.00e+01
   平均绝对误差：7.16e+00]

## 4.遇到的问题与解决方法

**主要问题：**
[solve_bvp不收敛，使用线性初始猜测时求解失败]

**解决方法：**
[改用有限差分解作为初始猜测]

## 5. 总结与心得体会

**主要收获：**
[掌握了边值问题的两种数值解法原理和实现，理解了离散化精度对解的影响，学会调试数值算法，处理收敛性问题，认识到初始猜测对迭代法的重要性]


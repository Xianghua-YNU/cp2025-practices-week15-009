# 项目1：双摆动力学仿真 - 实验报告

**学生姓名：** [余维]  
**学号：** [20231050005]  
**完成日期：** [2025/6/6]

## 1. 实验目的
（理解双摆系统的非线性动力学特性：
通过数值求解双摆系统的运动方程，探究其复杂的非线性行为，包括混沌运动和对初始条件的敏感性。

验证能量守恒定律：
计算并分析双摆系统在运动过程中的总能量变化，验证封闭系统中机械能守恒定律在数值模拟中的表现。

掌握数值求解技术：
学习使用scipy.integrate.odeint求解器对复杂微分方程组进行数值积分，理解求解器参数（如容差rtol/atol）对结果精度的影响。

实现物理过程可视化：
利用matplotlib动画功能将双摆的运动轨迹可视化，直观展示双摆的动力学行为。）

## 2. 核心算法与实现

### 2.1 运动方程的数值解法
（derivatives 函数的关键作用
定义运动方程：该函数实现了双摆系统的核心动力学方程

状态转换：将二阶微分方程转换为一阶方程组

参数传递：接受物理参数（摆长L，质量m，重力g）

方程实现：计算角加速度项 dω/dt。）

### 2.2 能量计算方法
（势能 V 的计算
系统势能完全来源于重力势能，由两个摆锤的位置决定：

第一摆锤高度：相对于悬挂点下降 $L\cos\theta_1$（当 $\theta_1=0$ 时在最低点）

第二摆锤高度：相对于第一摆锤再下降 $L\cos\theta_2$

总势能表达式：
V=−mgL(2cosθ1+cosθ2)

物理意义：

负号表示位置低于参考点（悬挂点）

$2\cos\theta_1$ 项：包含第一摆锤及其对第二摆锤基础位置的影响

$\cos\theta_2$ 项：第二摆锤相对于第一摆锤的附加高度

2. 动能 T 的计算
系统动能包含两个摆锤的运动能量：

第一摆锤动能：由角速度 $\omega_1$ 决定，形式为 $\frac{1}{2}m(L\omega_1)^2$

第二摆锤动能：更复杂，因其运动是第一摆锤运动与自身相对运动的合成

物理意义：

$\omega_1^2$ 项：第一摆锤的基础动能

$\frac{1}{2}\omega_2^2$ 项：第二摆锤相对第一摆锤的动能

$\omega_1\omega_2\cos(\theta_1 - \theta_2)$ 项：两摆锤运动的耦合项，取决于角度差

3. 总能量 E

关键特性：

守恒性：在理想物理系统中应保持恒定

验证功能：数值模拟中作为精度指标

耦合特征：包含角度差 $\theta_1 - \theta_2$ 的余弦项，反映双摆的特殊动力学）

### 2.3 关键代码片段
```python
def derivatives(y, t, L1, L2, m1, m2, g_param):
    theta1, omega1, theta2, omega2 = y
    
    dtheta1_dt = omega1
    dtheta2_dt = omega2
    
    # domega1/dt 的计算
    num1 = -omega1**2 * np.sin(2*theta1 - 2*theta2) \
           - 2 * omega2**2 * np.sin(theta1 - theta2) \
           - (g_param/L1) * (np.sin(theta1 - 2*theta2) + 3*np.sin(theta1))
    den1 = 3 - np.cos(2*theta1 - 2*theta2)
    domega1_dt = num1 / den1

    # domega2/dt 的计算
    num2 = 4 * omega1**2 * np.sin(theta1 - theta2) \
           + omega2**2 * np.sin(2*theta1 - 2*theta2) \
           + 2 * (g_param/L1) * (np.sin(2*theta1 - theta2) - np.sin(theta2))
    den2 = 3 - np.cos(2*theta1 - 2*theta2)
    domega2_dt = num2 / den2
    
    return [dtheta1_dt, domega1_dt, dtheta2_dt, domega2_dt]
```

## 3. 实验结果与分析

### 3.1 能量守恒分析
（粘贴你生成的“能量 vs. 时间”图像。分析图像，讨论能量是否守恒。如果存在数值误差导致的不守恒，量化这个误差（例如，总能量的变化范围或标准差），并讨论你是如何通过调整 `odeint` 的参数（如 `rtol`, `atol`）或增加 `t_points` 来尝试满足题目 $10^{-5}$ 焦耳的精度要求的。）

**(在此处插入能量随时间变化的图像)**

### 3.2 双摆运动轨迹 (可选，如果未做动画则省略)
（如果你完成了动画部分，可以简要描述双摆的典型运动特征，例如混沌行为、对初始条件的敏感性等。可以附上一张动画中的截图。）

**(在此处插入动画截图，如果适用)**

## 4. 问题与收获

### 4.1 遇到的主要问题
（能量守恒精度问题

核心困难：数值解算导致能量漂移，初始实现无法达到$10^{-5}$焦耳的能量守恒要求

具体表现：

默认ODE求解参数下能量变化达$10^{-3}$量级

长时间模拟后能量漂移明显

根本原因：

数值积分方法的固有截断误差

双摆系统的刚性特征（高频振荡）

运动方程实现挑战

公式复杂性：

耦合项$\cos(\theta_1-\theta_2)$导致强非线性

分母项$3-\cos(2\theta_1-2\theta_2)$在特定角度趋近零（数值不稳定）

验证困难：

缺乏解析解作为基准

物理直觉与数值结果的匹配度验证

动画性能与精度平衡
）

### 4.2 解决方法与学习心得
（能量守恒精度优化：

将odeint容差参数设为rtol=1e-9, atol=1e-9

增加时间分辨率（2000→5000点）

实现能量实时监控与自适应坐标轴缩放

验证：能量变化从10⁻³降至10⁻⁶量级

运动方程稳定性增强：

添加分母零点保护：den = max(den, 1e-10)

采用小角度初始化验证公式正确性

交叉验证：对比不同步长的能量一致性）

### 4.3 主要收获
（第一性原理实践：

从拉格朗日方程出发完整实现物理系统

深刻理解理论公式与数值实现的鸿沟

误差意识培养：

区分物理模型误差和数值计算误差

掌握误差量化分析方法（如能量漂移）

混沌概念具象化：

通过双摆直观理解"蝴蝶效应"

认识到确定性系统中的内在随机性）

## 5. 思考题（可选）

1.  如果双摆的两个摆臂长度不同（ $L_1 \neq L_2$）或两个摆锤质量不同（ $m_1 \neq m_2$），运动方程会如何变化？你将如何修改你的 `derivatives` 函数来适应这种情况？（提示：需要回顾拉格朗日方程的推导或查找更通用的双摆方程。）

运动方程将变得更加复杂
def derivatives_general(y, t, L1, L2, m1, m2, g):
    theta1, omega1, theta2, omega2 = y
    dtheta = theta1 - theta2
    
    # 构造质量矩阵
    M11 = (m1 + m2) * L1**2
    M12 = m2 * L1 * L2 * np.cos(dtheta)
    M21 = M12
    M22 = m2 * L2**2
    
    # 构造力向量
    F1 = -m2 * L1 * L2 * omega2**2 * np.sin(dtheta) - (m1 + m2) * g * L1 * np.sin(theta1)
    F2 = m2 * L1 * L2 * omega1**2 * np.sin(dtheta) - m2 * g * L2 * np.sin(theta2)
    
    # 求解线性方程组
    A = np.array([[M11, M12], [M21, M22]])
    b = np.array([F1, F2])
    accelerations = np.linalg.solve(A, b)
    
    return [omega1, accelerations[0], omega2, accelerations[1]]
    
2.  双摆的运动对初始条件高度敏感。尝试稍微改变初始角度（例如，将 $\theta_1$ 或 $\theta_2$ 改变 $0.001$ 弧度），重新运行仿真，并比较两个轨迹（例如，绘制 $\theta_1(t)$ 的对比图）。你观察到了什么现象？这与混沌理论有什么关系？

观察现象：

t=0-5秒：轨迹几乎重合

t=10-15秒：出现可见偏差

t>20秒：完全不同的运动模式

混沌理论解释：

李雅普诺夫指数：双摆系统有正李雅普诺夫指数 λ>0，导致初始误差指数增长：

δ(t)≈δ(0)e λt

相空间特性：

吸引子结构复杂（分形维数）

轨迹在相空间中指数分离

微小扰动可使轨迹从稳定周期区进入混沌区

物理本质：

能量在自由度间非线性转移

运动模式切换（周期↔混沌）对初值敏感

预测时间有限性：

t predict ≈ 1/λln 1/δ 0
​
实际意义：

解释了天气预报等现实系统中长期预测的困难

展现了确定性系统中的内在随机性

为量子混沌研究提供基础模型

---

_报告长度建议：500-1000字（不含代码和图片），重点关注对物理模型、数值方法和结果分析的理解与反思。_
